/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspCServletContext/1.0
 * Generated at: 2016-04-24 02:14:06 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.ibm.scas.analytics.backend.appdirect.AppDirectGatewayFactory;
import com.google.inject.Injector;
import javax.xml.crypto.dsig.keyinfo.RetrievalMethod;
import com.ibm.scas.analytics.beans.NotificationResult;
import com.ibm.scas.analytics.backend.appdirect.AppDirectGateway;
import com.ibm.scas.analytics.utils.ExpiredPromoCodeException;
import com.ibm.scas.analytics.utils.InvalidPromoCodeException;
import com.ibm.scas.analytics.utils.PromoCode;
import org.apache.log4j.Logger;
import com.ibm.scas.analytics.beans.NotificationEvent;
import com.google.gson.Gson;
import com.ibm.scas.analytics.utils.OauthAdapter;
import com.ibm.scas.analytics.provider.impl.ServiceProviderPluginFactory;
import com.ibm.scas.analytics.provider.ServiceProvider;
import com.ibm.scas.analytics.persistence.beans.Offering;
import com.ibm.scas.analytics.persistence.beans.AllClusterDetails;
import java.util.List;
import com.ibm.scas.analytics.persistence.beans.Account;
import com.ibm.scas.analytics.persistence.PersistenceService;
import com.ibm.scas.analytics.EngineProperties;
import java.util.Enumeration;

public final class access_002dcontrol_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=ISO-8859-1");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("<!DOCTYPE html>\r\n<html>\r\n");

	Logger logger = Logger.getLogger("com.ibm.scas.analytics.JSP.access-control");

	boolean testMode = "true".equalsIgnoreCase(EngineProperties.getInstance().getProperty(EngineProperties.TEST_MODE));
	String marketplaceUrl = EngineProperties.getInstance().getProperty(EngineProperties.MARKETPLACE_URL);
	
	if (testMode) {
		session.setAttribute("offeringId", "bi-qse");
		
		session.setAttribute("companyName", "Acme");
		session.setAttribute("firstName", "John");
		session.setAttribute("lastName", "Doe");
		session.setAttribute("email", "john.doe@acme.com");

	}

	String offeringId = (String) session.getAttribute("offeringId");
	String companyName = (String) session.getAttribute("companyName");
	String firstName = (String) session.getAttribute("firstName");
	String lastName = (String) session.getAttribute("lastName");
	String email = (String) session.getAttribute("email");
	
	String contextPath = request.getContextPath();

	/* TODO: remove direct reference to persistence layer here and pass it in from Controller class */
	final Injector inj = (Injector) pageContext.getServletContext().getAttribute(Injector.class.getName());
	final PersistenceService persistence = inj.getInstance(PersistenceService.class);
	final AppDirectGatewayFactory adgf = inj.getInstance(AppDirectGatewayFactory.class);
	Offering offering = persistence.getObjectById(Offering.class, offeringId);
	String offeringName = offering.getName();
	String subOfferingName = "";
	{
		int index = offeringName.indexOf('|');
		if (index > 0) {
			subOfferingName = offeringName.substring(index + 1);
			offeringName = offeringName.substring(0, index);
		}
	}
	if (testMode) {
		offeringName += " (Local test mode)";
	}
	
	String cpeVersion = EngineProperties.getInstance().getProperty(EngineProperties.CPE_VERSION);
	String cpeBuild = EngineProperties.getInstance().getProperty(EngineProperties.CPE_BUILD);
	
	// TODO: remove direct reference to injector here and retrieve offering from controller class instead */
	ServiceProvider plugin = inj.getInstance(ServiceProviderPluginFactory.class).getPlugin(offeringId);
	String pluginVersion = plugin.getVersion();
	String pluginBuild = plugin.getBuild();

	String accessCode = "foo";
	boolean retry = false;
	
	String method = request.getMethod().toUpperCase();
	if ("GET".equals(method)) {
		session.setAttribute("retryCount", 3);
	
	} else if ("POST".equals(method)) {
		accessCode = request.getParameter("access_code");
		if (logger.isDebugEnabled()) {
			logger.debug("offeringId: " + offeringId);
			logger.debug("email: " + email);
			logger.debug("Access code: " + accessCode);
		}
		
		boolean verified = false;
		try {
			PromoCode.validate(offeringId, email, accessCode);
			logger.info("-- VALIDATED ACCESS CODE --");
			verified = true;
		} catch (InvalidPromoCodeException e) {
			logger.info("-- INVALID ACCESS CODE --");
		} catch (ExpiredPromoCodeException e) {
			logger.info("-- EXPIRED ACCESS CODE --");
		}
		
		if (!verified) {
			Integer retryCount = (Integer) session.getAttribute("retryCount");
			-- retryCount;
			if (retryCount == 0) {
				logger.error("No more retry. Cancelling order...");
			} else {
				session.setAttribute("retryCount", retryCount);
				logger.debug(retryCount + " retries remaining.");
				retry = true;
			}
		}

		if (!retry) {
			OauthAdapter adapter = new OauthAdapter(offering.getOauthKey(), offering.getOauthSecret());
	
			String eventJson = (String) session.getAttribute("eventJson");
			Gson gson = new Gson();
			NotificationEvent event = gson.fromJson(eventJson, NotificationEvent.class);
	
			String resultParams;
			if (verified) {
				NotificationResult result = adgf.create(false).processEvent(offeringId, event);
	
				resultParams = "&success=" + result.getSuccess() + "&accountIdentifier=" + result.getAccountIdentifier();
			} else {
				resultParams = "&success=false&errorCode=OPERATION_CANCELLED&message=Invalid+Access+Code";
			}
	
			String signedUrl = adapter.signUrl(event.getReturnUrl() + resultParams);
	
			response.sendRedirect(signedUrl);
		}
	}


      out.write("<head>\r\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\r\n\t<title>");
      out.print(offeringName);
      out.write("</title>\r\n\t<meta name=\"description\" content=\"Explore hundreds of IBM and Business Partner services from across the cloud spectrum.\"/>\r\n\t<meta name=\"keywords\" content=\"Cloud marketplace Explore hundreds of IBM and Business Partner services from across the cloud spectrum.\"/>\r\n\t<meta name=\"pageName\" content=\"HomePage\"/>\r\n\t<link rel=\"SHORTCUT ICON\" href=\"theme/images/icon-favicon.ico\">\r\n\r\n\t<!--Include stylesheets -->\r\n\t<link href=\"//1.www.s81c.com/common/v17/css/www.css\" rel=\"stylesheet\" title=\"www\" type=\"text/css\" />\r\n\t<link rel=\"stylesheet\" href=\"");
      out.print(contextPath);
      out.write("/theme/css/cloud-marketplace.css\" type=\"text/css\" />\t\t    \r\n\r\n\t<link rel=\"stylesheet\" href=\"");
      out.print(contextPath);
      out.write("/theme/icas-analytics.css\" title=\"www\" type=\"text/css\" />\r\n\t<link rel=\"stylesheet\" href=\"//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dijit/themes/claro/claro.css\" media=\"screen\"/>\r\n\t<link rel=\"stylesheet\" href=\"//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojox/grid/resources/Grid.css\" />\r\n\t<link rel=\"stylesheet\" href=\"//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojox/grid/resources/claroGrid.css\" />\r\n</head>\r\n\r\n\r\n<body id=\"ibm-cloud-marketplace\" class=\"claro\">\r\n\r\n\t<div id=\"marketplace-page-wrapper\">\t\t\r\n\t\t<header id=\"header-cloud-marketplace\">\r\n\t\t\t<div class=\"primary-nav-container bg-default-blue\">\r\n\t\t\t\t<nav class=\"desktop\">\t\t\t\t\t\t\r\n\t\t\t\t\t<div class=\"ibm-logo-container fleft\">\r\n\t\t\t\t\t\t<a href=\"http://www.ibm.com/marketplace/cloud/us/en-us/\" class=\"ibm-logo\">\r\n\t\t\t\t\t\t\t<img class=\"hamburger-icon desktop\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAQMAAABKLAcXAAAABlBMVEX///////9VfPVsAAAAAXRSTlMAQObYZgAAABxJREFUeAFjGNZgFNj/BwNyeUPAD6M+GnpgFAAAc4Rpyh7s7lcAAAAASUVORK5CYII=\" alt=\"IBM Cloud marketplace\" />\r\n\t\t\t\t\t\t</a>\r\n");
      out.write("\t\t\t\t\t</div>\r\n\t\t\t\t\t<!-- ibm-logo-container -->\t\r\n\r\n\t\t\t\t\t<div class=\"ibm-cloud-title fleft\">\r\n\t\t\t\t\t\t<h1><a href=\"http://www.ibm.com/cloud-computing/us/en/\">IBM <span>Cloud</span></a></h1>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<!-- ibm-cloud-title -->\r\n\r\n\t\t\t\t\t<ul class=\"primary-nav min-td-spce\">\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<span class=\"parent\">\r\n\t\t\t\t\t\t\t\t<a href=\"http://www.ibm.com/cloud-computing/us/en/\">About</a>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t<li><a href=\"http://www.ibm.com/cloud-computing/us/en/what-is-cloud-computing.html\">What is Cloud Computing</a></li>\r\n\t\t\t\t\t\t\t\t<li><a href=\"http://www.ibm.com/cloud-computing/us/en/why-cloud.html\">Why IBM Cloud</a></li>\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t<li><a href=\"");
      out.print(marketplaceUrl);
      out.write("\">Marketplace</a></li>\r\n\t\t\t\t\t\t<li><a href=\"http://www.ibm.com/cloud-computing/us/en/partner-landing.html\">Partners</a></li>\r\n\t\t\t\t\t\t<li><a href=\"http://www.ibm.com/cloud-computing/us/en/cloud-solutions/\">Solutions</a></li>\r\n\t\t\t\t\t\t<li><a href=\"https://developer.ibm.com/marketplace/\">Community</a></li>\t\t\r\n\t\t\t\t\t\t<li><a href=\"#\" class=\"active\">Cloud Analytics</a></li>\r\n\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<span class=\"parent\">");
      out.print( firstName );
      out.print( lastName );
      out.write("<span class=\"user-icon\"></span></span>\r\n\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t<li><a href=\"logout.jsp\" >Logout</a></li>\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</li>\t\t\t\t\t\t\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t<!-- page navigation links -->\r\n\t\t\t\t</nav>\r\n\t\t\t\t<!-- nav bar -->\r\n\t\t\t</div>\r\n\t\t\t<!-- marketplace-global-nav -->\r\n\t\t</header>\t\r\n\t\t<!-- page header -->\r\n\r\n\t\t<section id=\"page-content\" class=\"cloud-default-layout\">\r\n\t\t\t<div id=\"welcome-page\" class=\"wrapper\">\r\n\r\n<div id=\"promo_code_container\">\r\n<!-- BEGIN CPE CONTENT -->\r\n<div class=\"ibm-columns\" style=\"padding-top: 40px; overflow: visible\">\r\n\t<div class=\"ibm-col-6-6\">\r\n\t\t<div id=\"cpe-dashboard\">\r\n\t\t\t<div data-dojo-type=\"platform/accesscontrol\" data-dojo-props=\"offeringId: '");
      out.print(offeringId);
      out.write("', offeringName: '");
      out.print(offeringName);
      out.write("', subOfferingName: '");
      out.print(subOfferingName);
      out.write("', email: '");
      out.print(email);
      out.write("', accessCode: '");
      out.print(accessCode);
      out.write("', retry: ");
      out.print(retry);
      out.write(", contextUrl: '");
      out.print(contextPath);
      out.write("/dynamic/");
      out.print(offering.getUrlPath());
      out.write("'\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<!-- BEGIN CPE CONTENT -->\r\n</div>\r\n\r\n</div>\r\n\t\t</section>\r\n<!-- Main dojo entry point -->\r\n<script>\r\n");
      out.write("\r\n    dojoConfig= {\r\n        has: {\r\n            \"dojo-firebug\": true\r\n        },\r\n        packages: [\r\n            { name: \"platform\", location: \"");
      out.print(contextPath);
      out.write("/js/platform\" }\r\n        ],\r\n        parseOnLoad: true,\r\n        async: true\r\n    };\r\n</script>\r\n<script src=\"//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojo/dojo.js\"></script>\r\n<script>\r\n\trequire(\r\n\t\t[\"dojo/parser\", \"platform/accesscontrol\", \"dojo/domReady!\"],\r\n\t\tfunction(parser){\r\n\t\t\tparser.parse();\r\n\t\t}\r\n\t);\r\n</script>\r\n\r\n<div id=\"build-info\">\r\n<p>Platform version: ");
      out.print( cpeVersion );
      out.write(' ');
      out.write('/');
      out.write(' ');
      out.print( cpeBuild);
      out.write(" | Plugin version: ");
      out.print( pluginVersion );
      out.write(' ');
      out.write('/');
      out.write(' ');
      out.print( pluginBuild);
      out.write("</p>\r\n</div>\r\n\r\n\t</div>\r\n\t<!-- marketplace-page-wrapper -->\r\n\r\n\t<footer id=\"cloud-marketplace-footer\" class=\"footer\">\r\n\t\t<div class=\"container info-bar\">\r\n\t\t\t<ul class=\"contacts fleft\">\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a href=\"https://www14.software.ibm.com/webapp/iwm/web/signup.do?source=gtsmail&lang=en_US&S_TACT=602AX26W\" class=\"contact-link email\" title=\"Email\">&nbsp;</a>\r\n\t\t\t\t\t<span class=\"contact-link tele\" title=\"Telephone\">&nbsp;</span>\r\n\t\t\t\t</li>\t\t\t\t\t\r\n\t\t\t\t<li class=\"contact-dt\">\r\n\t\t\t\t\tUS &amp; Canada: 1-877-999-7115 (Priority code 103HA09T)\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t\t<!-- contact details -->\r\n\r\n\t\t\t<ul class=\"social fright\">\r\n\t\t\t\t<span class=\"visit-us\">Visit us</span>\r\n\t\t\t\t<li><a class=\"social-link tw\" href=\"https://twitter.com/ibmcloud/\" title=\"Twitter\" target=\"_blank\"></a></li>\r\n\t\t\t\t<li><a class=\"social-link yt\" href=\"http://www.youtube.com/user/ibmcloud/\" title=\"Youtube\" target=\"_blank\"></a> </li>\t\r\n\t\t\t\t<li><a class=\"social-link in\" href=\"https://www.linkedin.com/groups/IBM-Cloud-Computing-2002441\" title=\"LinkedIn\" target=\"_blank\"></a> </li>\t\r\n");
      out.write("\t\t\t\t<li><a class=\"social-link fb\" href=\"https://www.facebook.com/IBMCloud\" title=\"Facebook\" target=\"_blank\"></a> </li>\t\r\n\t\t\t\t<li><a class=\"social-link wp\" href=\"http://thoughtsoncloud.com/\" title=\"Wordpress\" target=\"_blank\"></a> </li>\t\r\n\t\t\t\t<li><a class=\"social-link gp last\" href=\"https://plus.google.com/+ibmcloud/posts\" title=\"Google+\" target=\"_blank\"></a></li>\r\n\t\t\t</ul>\r\n\t\t\t<!-- social media links -->\r\n\t\t</div>\r\n\t\t<!-- info-bar -->\r\n\r\n\t\t<hr/>\r\n\t\t<div class=\"container\">\r\n\t\t\t<ul class=\"footer-links\">\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a href=\"http://www.ibm.com/us/en/\" class=\"footer-link ibm-logo first\">\r\n\t\t\t\t\t\t<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABaCAAAAADYnUYKAAAAAnRSTlMA/1uRIrUAAAV0SURBVHgB7dr9T1NXGAfw/U9PJDPGbYps0ixLTMZeTBbnFI0D5qgviMpQRwtMugUTX1BrVutgJSG+IDocM3OKUcEYIc4pohatirGbhVYoQr4L2sI55Tn33l7Gupnz+a29z729Xzm539tbX8MrQgfRQXQQHUQH0UF0kFc0yFdk6iKAYrJmzifbTg1A1khKn0LBQ0pz+SAVZKoTQAlZl11zG6ImUusHbyEp5fBBKsnUZQCbKC21Y5h0hNQCYHWRmoMPstna0vqC0jOvAxMCpJYHVjmpzeaD7HzbYSw3txvAN+oxTu4sx00ktb6jnnOEwVmx0KGycAkfZOzZiLF4HABG1WO8x2EkjQ2pDx6LgxMdHlEZfq575P8RJBw0NQwgFrRjGOMGg0b6mYUVNBKaVo+cIjuK+B6RzP4LqfJITdkj28hUB4BWsuWeeRDyIcVVMjR/WoXYRrZ8zxeiZBFSlJGauhDLrBXiCbJlFV+IsjOQ9JOxOXyQHW/mmMjuAvDbvBwb5q0GgJNvGQ69UQXJ4deNj7mYDzISeWYsFh0DMDoQe5a+gRhe7Gs4FHkKyYDxGQ0O6ULMEB1kZ37hpIL8i+A9KlglzK3cMAzRhfwC6SinIWpYVshZfhwTuld+zo2sKghbDvIhSQLg3SRZFKIAyQ5AtNa8rEtI4b7lIIUkOQ7eHZIsiEHUTLJfIXKRwu9IGJ5LCg8tBymwFSTbOMgta5291fxrcchykI+sLa2etJbWc4jcs7JYs96N4yWnaiLL+l+ks1USAi8qj50ehSjUKrkEydN7Id6dZOC++yGFUd0jmaaD1BU5BUUd4PU7i53W5O9FikbpI4qFV0U7AKC5SNhaLM06/7Qc5AMbhWisAynWkNpjANmUkIFCNNCKVC65z78kwSHgOgkci/+hQmyebpBaSJhH/ydy5G+8tSRw19oNYvNeS8WFqVwkCXmkV2NZJLhabXdptXn9ggO94EUO+vzmvC1ghG8FJ929jfjk67s9sRHv5JF9fnSK5+PzR3WPZJoOEqiSdIMXrrLkOBg/yTNBPNlaxaq4AhypkkQsB1lEknrwbpA1dZhqNUnOYogUrgNLSHIvY4W4z/Ty2wkEiLUcQEnGC1H9T1ExJchgFnEaAKy3GySPJD9O/16rDSmKSXIOwAbiPACw1O7Sat3lFezqAe+pd5/Xmu+OIUX7TmHz/roHAEJ79ntT7W4CgNPi8F6vLsSM00Ga3B6B+xp4Yc92Yax6dxyia5UeQdUBSH52CRtrqvsw7pTLI6lxRTCuWXx/uycy01etKEQNJAuaXbWYH8PmjADTuWoVzsSTxhbjQuRuKegoAL4QM/jst85CED9JZg9NM8j7qeXKu2G4tOpJtsJoaZ1NNBNJyoHpLa1ARaXA1Q3ek0q3OFYbh6jL5ZaOUg/RSfEj3K4gXmqsEN9NnvFhabgyonskM3SQiz6/sYO+fgBB4zHlvoMAenyKjY+QENzrT/A1IemMvBszIQVZR6bOAzhG9sQA/EAK7Uh4SBPWIGkZKWTiP9UUG/6c1omkr5mrbAnxcjMR5ITFIH9QwlKYBnHYXlrtAI6SHQvGAOAQKZzDhPemPvj+LL2l1bJpi7HysrsArm0uV48o9+zCuMubFZvvYMKFF6dR5hrFhMaNWzhl3+oe+VfpIJ0BU48B9AXS5K2LIaE3oNAPwS+BgD8EQXuAd4wPsmamrlp74kjwk8JZCLakfudY+p8oxOW9SDDsEUEfkROAjR6ZwSB5TUC6QfAxtQCYyUI8n97Sml/SBolRIQpcNAjAdiEedW40VlpyG0D3utKN5kpLaxouRZGiY20pO7y+F6IrtZDU82e2rlr3CEcH0UF0EB1EB9FBXgF/Aw1Wo7IO5udsAAAAAElFTkSuQmCC\" alt=\"IBM\">\r\n");
      out.write("\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li><a class=\"footer-link\" href=\"http://www.ibm.com/contact/us/en/?lnk=flg-cont-usen\">Contact IBM</a></li>\r\n\t\t\t\t<li><a class=\"footer-link\" href=\"http://www.ibm.com/privacy/us/en/?lnk=flg-priv-usen\">Privacy</a></li>\r\n\t\t\t\t<li><a class=\"footer-link\" href=\"http://www.ibm.com/legal/us/en/?lnk=flg-tous-usen\">Terms of Use</a></li>\r\n\t\t\t\t<li><a class=\"footer-link\" href=\"http://www.ibm.com/accessibility/us/en/?lnk=flg-acce-usen\">Accessibility</a></li>\r\n\t\t\t\t<li><a class=\"footer-link\" id=\"ibm-cookie-preferences-link\" href=\"javascript: void(0);\">Cookie Preference</a></li>\r\n\t\t\t</ul>\r\n\t\t\t<div class=\"clearfix\"></div>\r\n\t\t</div>\r\n\t\t<!-- footer links -->\r\n\r\n\t</footer>\r\n\t<!-- page footer -->\r\n</body>\r\n</html>\r\n\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
